<body>
    <div id="display"></div>
    <div id="displaykota"></div>
    <div id="displaykecamatan"></div>
    <script>
        const display = document.getElementById("display");
        const dropdown = document.createElement("select");
        const displaykota1 = document.getElementById("displaykota");
        const displaykecamatan1 = document.getElementById("displaykecamatan");

        fetch('https://api.binderbyte.com/wilayah/provinsi?api_key=47864ad6e813ef7e6b387c023e141db00518a2018a134e67a9789fc951debccf')
            .then(response => response.json())
            .then(data => {
                data.value.forEach(datawil => {
                    const option = document.createElement('option');
                    option.value = datawil.id;
                    option.text = datawil.name;
                    dropdown.appendChild(option);
                });
                display.appendChild(dropdown);

                dropdown.addEventListener("change", e => {
                    const pilihID = e.target.value;
                    const pilihProv = data.value.find(datawil => datawil.id === pilihID);
                    if (pilihProv) {
                        displaykota1.innerHTML = `<h2>Daftar Kota:</h2>`;
                        
                        // Fetch data kota based on selected province ID
                        fetch(`https://api.binderbyte.com/wilayah/kabupaten?api_key=47864ad6e813ef7e6b387c023e141db00518a2018a134e67a9789fc951debccf&id_provinsi=${pilihID}`)
                            .then(response => response.json())
                            .then(dataKota => {
                                let displayKota = "";
                                dataKota.value.forEach(datakota => {
                                    displayKota += `
                                        <p>
                                            <button onclick="loadKecamatan('${datakota.id}')">Lihat Kecamatan</button>
                                            ${datakota.name}
                                        </p>`;
                                });
                                displaykota1.innerHTML = displayKota;
                            })
                            .catch(error => {
                                console.error(error);
                            });
                    }
                });
            })
            .catch(error => {
                console.error(error);
            });

        function loadKecamatan(idKota) {
            fetch(`https://api.binderbyte.com/wilayah/kecamatan?api_key=47864ad6e813ef7e6b387c023e141db00518a2018a134e67a9789fc951debccf&id_kabupaten=${idKota}`)
                .then(response => response.json())
                .then(dataKecamatan => {
                    let displayKecamatan = "<h2>Daftar Kecamatan:</h2>";
                    dataKecamatan.value.forEach(datakec => {
                        displayKecamatan += `<p>${datakec.name}</p>`;
                    });
                    displaykecamatan1.innerHTML = displayKecamatan;
                })
                .catch(error => {
                    console.error(error);
                });
        }
    </script>
</body>
